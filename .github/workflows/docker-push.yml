name: Docker Image CI  
  
on:  
  push:  
    branches: [ master ]  
  
jobs:  
  build-and-push:  
    runs-on: ubuntu-latest  
    permissions:  
      contents: read  
      packages: write  
  
    steps:  
      - name: Checkout  
        uses: actions/checkout@v3  
  
      - name: Set up Docker Buildx  
        uses: docker/setup-buildx-action@v2  
  
      - name: Login to GitHub Container Registry  
        uses: docker/login-action@v2  
        with:  
          registry: ghcr.io  
          username: ${{ github.repository_owner }}  # 这里也可以使用 github.actor 如果是个人仓库  
          password: ${{ secrets.GITHUB_TOKEN }}  
  
      - name: Build and push Docker images  
        uses: docker/build-push-action@v3  
        with:  
          context: .  
          push: true  
          tags: |  
            ghcr.io/${{ github.repository_owner }}/${{ github.event.repository.name }}:latest  
            ghcr.io/${{ github.repository_owner }}/${{ github.event.repository.name }}:${{ github.sha }}